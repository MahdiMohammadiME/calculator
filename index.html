<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NSF Calculator</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        input, button { margin: 5px; padding: 10px; }
        .output-section { margin-top: 15px; border-top: 1px solid #ccc; padding-top: 10px; }
        .output-section p { font-weight: bold; }
    </style>
</head>
<body>

    <h2>Negative Straight Flange Calculator</h2>

    <label for="shellThk">Shell THK:</label>
    <input type="number" id="shellThk" placeholder="Enter Shell THK">
    <br>
    <label for="headThk">Head THK:</label>
    <input type="number" id="headThk" placeholder="Enter Head THK">
    <br>
    <label for="shellId">Shell ID:</label>
    <input type="number" id="shellId" placeholder="Enter Shell ID">
    <br>
    
    <button onclick="getCalculation()">Calculate</button>

    <p id="status-message">Enter values above and click Calculate.</p>

    <div class="output-section">
        <p>Negative SF Length: <span id="output_sflength">--</span></p>
        <p>Head ID: <span id="output_headid">--</span></p>
        <p>Head OD: <span id="output_headod">--</span></p>
    </div>
    <script>
        // *** REPLACE THIS URL with the Web App URL you copied in Step 3 ***
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby1Vwoq8YQ9hDkREsJbLPma3RcVEx4K-EJwm5yyfcY/dev';

        // Get the specific output elements once
        const statusMessage = document.getElementById('status-message');
        const sfLengthOutput = document.getElementById('output_sflength');
        const headIdOutput = document.getElementById('output_headid');
        const headOdOutput = document.getElementById('output_headod');

        async function getCalculation() {
            statusMessage.innerText = 'Calculating...';

            const inputs = {
                ShellTHK: document.getElementById('shellThk').value,
                HeadTHK: document.getElementById('headThk').value,
                ShellID: document.getElementById('shellId').value
            };

            // Check if all fields are filled
            if (!inputs.ShellTHK || !inputs.HeadTHK || !inputs.ShellID) {
                statusMessage.innerText = 'Please enter all three values.';
                return;
            }

            try {
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    body: JSON.stringify(inputs)
                });

                const data = await response.json();
                
                // Check for all three results
                if (data.result1 !== undefined && data.result2 !== undefined && data.result3 !== undefined) {
                    
                    // Assign each result to its specific output span
                    sfLengthOutput.innerText = data.result1;
                    headIdOutput.innerText = data.result2;
                    headOdOutput.innerText = data.result3;
                    
                    statusMessage.innerText = 'Calculation Complete!';
                    
                } else {
                    // Update all output spans to indicate failure
                    sfLengthOutput.innerText = '--';
                    headIdOutput.innerText = '--';
                    headOdOutput.innerText = '--';
                    statusMessage.innerText = 'Calculation failed or returned missing values.';
                    console.error('Server response data was missing expected results:', data);
                }

            } catch (error) {
                console.error('Fetch Error:', error);
                statusMessage.innerText = 'An error occurred during calculation. Check the console for details.';
            }
        }
    </script>

</body>
</html>
